<!DOCTYPE html>
<html lang = "en">
<head>
    <title>TEST</title>
    <meta charset = "utf-8" />
    <link rel="stylesheet" type="text/css" href="css/main.css">

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script  src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-analytics.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-database.js"></script>


    <script src="app.js"></script>

    <script>
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                document.getElementById("mainButton").innerHTML = "<button id = \"logout\" onclick = \"signUserOut()\">Logout</button>";
            } else {
                // No user is signed in.
                document.getElementById("mainButton").innerHTML = "<a href = \"login.html\"><button id = \"get-started\">Get started</button></a>";
            }
            document.getElementById("loading").style.display = "none";
        });
    </script>

    <script>
        function signUserOut()
        {
            firebase.auth().signOut().then(function() {
                // Sign-out successful.
            }).catch(function(error) {
                // An error happened.
            });
        }
        function fireWrite(thingToChange, changeTo) {
            database.ref(thingToChange +  '/').set({
                thingToChange: changeTo
            });
        }
        function updateMessage()
        {
            fireWrite("message", document.getElementById("messageSent").value);
            var messageRef = firebase.database().ref("message/");
            messageRef.on('value', getData, errData);
        }
        var messageRef = firebase.database().ref("message/");
        messageRef.on('value', getData, errData);
        function getData(data)
        {
            var message = data.val();
            var key = Object.keys(message);
            document.getElementById("message").innerHTML = document.getElementById("messageUser").value + ": " + message[key];
        }
        function errData(err)
        {
            console.log("Error!");
            console.log(err);
        }
    </script>

</head>
<body>
<nav>
    <ul>
        <li class = "left-nav"><h1>Tutor for you</h1></li>
        <li class = "left-nav"><h2>Tutoring</h2></li>
        <li class = "left-nav"><h2>Options</h2></li>
        <li class = "left-nav"><h2>About</h2></li>
        <li id = "mainButton"></li>
    </ul>
</nav>
<p id = "message"></p>
<br>
Name:
<input type = "text" id = "messageUser">
Message:
<input type = "text" id = "messageSent" />
<button onclick = "updateMessage();">Submit Message</button>
<div id = "loading">
</div>
</body>
</html>